import{j as e,Q as t,a}from"./query-cddaec37.js";import{a as r,r as s,g as n,b as c}from"./vendor-7fea2497.js";import{L as i,u as l,B as o,R as d,a as m}from"./router-596e79fe.js";import{O as x}from"./ui-20145449.js";import{X as h}from"./storage-de55096e.js";import{t as g,c as u}from"./utils-1bf6da94.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var y={},p=r;y.createRoot=p.createRoot,y.hydrateRoot=p.hydrateRoot;
/**
 * @license lucide-react v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const f=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},b=(...e)=>e.filter((e,t,a)=>Boolean(e)&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),v=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var j={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=s.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:n="",children:c,iconNode:i,...l},o)=>s.createElement("svg",{ref:o,...j,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:b("lucide",n),...!c&&!v(l)&&{"aria-hidden":"true"},...l},[...i.map(([e,t])=>s.createElement(e,t)),...Array.isArray(c)?c:[c]])),N=(e,t)=>{const a=s.forwardRef(({className:a,...r},n)=>{return s.createElement(w,{ref:n,iconNode:t,className:b(`lucide-${c=f(e),c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,a),...r});var c});return a.displayName=f(e),a},k=N("arrow-up-narrow-wide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),S=N("bell-off",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]]),A=N("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),E=N("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),D=N("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),C=N("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),I=N("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),P=N("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),L=N("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),M=N("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),O=N("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),z=N("moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),$=N("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),F=N("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),T=N("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),H=N("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),U=N("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),G=N("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),_=N("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),R=N("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),V=N("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),q=N("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),J=N("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),B=N("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W=e=>{let t;const a=new Set,r=(e,r)=>{const s="function"==typeof e?e(t):e;if(!Object.is(s,t)){const e=t;t=(null!=r?r:"object"!=typeof s||null===s)?s:Object.assign({},t,s),a.forEach(a=>a(t,e))}},s=()=>t,n={setState:r,getState:s,getInitialState:()=>c,subscribe:e=>(a.add(e),()=>a.delete(e)),destroy:()=>{a.clear()}},c=t=e(r,s,n);return n};
/**
 * @license lucide-react v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Y={exports:{}},K={},Q={exports:{}},X={},Z=s;var ee="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},te=Z.useState,ae=Z.useEffect,re=Z.useLayoutEffect,se=Z.useDebugValue;function ne(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!ee(e,a)}catch(r){return!0}}var ce="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),r=te({inst:{value:a,getSnapshot:t}}),s=r[0].inst,n=r[1];return re(function(){s.value=a,s.getSnapshot=t,ne(s)&&n({inst:s})},[e,a,t]),ae(function(){return ne(s)&&n({inst:s}),e(function(){ne(s)&&n({inst:s})})},[e]),se(a),a};X.useSyncExternalStore=void 0!==Z.useSyncExternalStore?Z.useSyncExternalStore:ce,Q.exports=X;var ie=Q.exports,le=s,oe=ie;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var de="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},me=oe.useSyncExternalStore,xe=le.useRef,he=le.useEffect,ge=le.useMemo,ue=le.useDebugValue;K.useSyncExternalStoreWithSelector=function(e,t,a,r,s){var n=xe(null);if(null===n.current){var c={hasValue:!1,value:null};n.current=c}else c=n.current;n=ge(function(){function e(e){if(!l){if(l=!0,n=e,e=r(e),void 0!==s&&c.hasValue){var t=c.value;if(s(t,e))return i=t}return i=e}if(t=i,de(n,e))return t;var a=r(e);return void 0!==s&&s(t,a)?(n=e,t):(n=e,i=a)}var n,i,l=!1,o=void 0===a?null:a;return[function(){return e(t())},null===o?void 0:function(){return e(o())}]},[t,a,r,s]);var i=me(e,n[0],n[1]);return he(function(){c.hasValue=!0,c.value=i},[i]),ue(i),i},Y.exports=K;const ye=n(Y.exports),{useDebugValue:pe}=c,{useSyncExternalStoreWithSelector:fe}=ye;const be=e=>e;const ve=e=>{const t="function"==typeof e?(e=>e?W(e):W)(e):e,a=(e,a)=>function(e,t=be,a){const r=fe(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,a);return pe(r),r}(t,e,a);return Object.assign(a,t),a},je=e=>e?ve(e):ve,we=new Map,Ne=e=>{const t=we.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([e,t])=>[e,t.getState()])):{}},ke=(e,t={})=>(a,r,s)=>{const{enabled:n,anonymousActionType:c,store:i,...l}=t;let o;try{o=null!=n&&n&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(u){}if(!o)return e(a,r,s);const{connection:d,...m}=((e,t,a)=>{if(void 0===e)return{type:"untracked",connection:t.connect(a)};const r=we.get(a.name);if(r)return{type:"tracked",store:e,...r};const s={connection:t.connect(a),stores:{}};return we.set(a.name,s),{type:"tracked",store:e,...s}})(i,o,l);let x=!0;s.setState=(e,t,n)=>{const o=a(e,t);if(!x)return o;const m=void 0===n?{type:c||"anonymous"}:"string"==typeof n?{type:n}:n;return void 0===i?(null==d||d.send(m,r()),o):(null==d||d.send({...m,type:`${i}/${m.type}`},{...Ne(l.name),[i]:s.getState()}),o)};const h=(...e)=>{const t=x;x=!1,a(...e),x=t},g=e(s.setState,r,s);if("untracked"===m.type?null==d||d.init(g):(m.stores[m.store]=s,null==d||d.init(Object.fromEntries(Object.entries(m.stores).map(([e,t])=>[e,e===m.store?g:t.getState()])))),s.dispatchFromDevtools&&"function"==typeof s.dispatch){const e=s.dispatch;s.dispatch=(...t)=>{e(...t)}}return d.subscribe(e=>{var t;switch(e.type){case"ACTION":return"string"!=typeof e.payload?void console.error("[zustand devtools middleware] Unsupported action format"):Se(e.payload,e=>{if("__setState"!==e.type)s.dispatchFromDevtools&&"function"==typeof s.dispatch&&s.dispatch(e);else{if(void 0===i)return void h(e.state);1!==Object.keys(e.state).length&&console.error('\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using \'store\' option in devtools(), the \'state\' should have only one key, which is a value of \'store\' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }\n                    ');const t=e.state[i];if(null==t)return;JSON.stringify(s.getState())!==JSON.stringify(t)&&h(t)}});case"DISPATCH":switch(e.payload.type){case"RESET":return h(g),void 0===i?null==d?void 0:d.init(s.getState()):null==d?void 0:d.init(Ne(l.name));case"COMMIT":return void 0===i?void(null==d||d.init(s.getState())):null==d?void 0:d.init(Ne(l.name));case"ROLLBACK":return Se(e.state,e=>{if(void 0===i)return h(e),void(null==d||d.init(s.getState()));h(e[i]),null==d||d.init(Ne(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Se(e.state,e=>{void 0!==i?JSON.stringify(s.getState())!==JSON.stringify(e[i])&&h(e[i]):h(e)});case"IMPORT_STATE":{const{nextLiftedState:a}=e.payload,r=null==(t=a.computedStates.slice(-1)[0])?void 0:t.state;if(!r)return;return h(void 0===i?r:r[i]),void(null==d||d.send(null,a))}case"PAUSE_RECORDING":return x=!x}return}}),g},Se=(e,t)=>{let a;try{a=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}void 0!==a&&t(a)};function Ae(e,t){let a;try{a=e()}catch(r){return}return{getItem:e=>{var r;const s=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),n=null!=(r=a.getItem(e))?r:null;return n instanceof Promise?n.then(s):s(n)},setItem:(e,r)=>a.setItem(e,JSON.stringify(r,null==t?void 0:t.replacer)),removeItem:e=>a.removeItem(e)}}const Ee=e=>t=>{try{const a=e(t);return a instanceof Promise?a:{then:e=>Ee(e)(a),catch(e){return this}}}catch(a){return{then(e){return this},catch:e=>Ee(e)(a)}}},De=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((e,t)=>(a,r,s)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},c=!1;const i=new Set,l=new Set;let o;try{o=n.getStorage()}catch(y){}if(!o)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),a(...e)},r,s);const d=Ee(n.serialize),m=()=>{const e=n.partialize({...r()});let t;const a=d({state:e,version:n.version}).then(e=>o.setItem(n.name,e)).catch(e=>{t=e});if(t)throw t;return a},x=s.setState;s.setState=(e,t)=>{x(e,t),m()};const h=e((...e)=>{a(...e),m()},r,s);let g;const u=()=>{var e;if(!o)return;c=!1,i.forEach(e=>e(r()));const t=(null==(e=n.onRehydrateStorage)?void 0:e.call(n,r()))||void 0;return Ee(o.getItem.bind(o))(n.name).then(e=>{if(e)return n.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return e.state;if(n.migrate)return n.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(e=>{var t;return g=n.merge(e,null!=(t=r())?t:h),a(g,!0),m()}).then(()=>{null==t||t(g,void 0),c=!0,l.forEach(e=>e(g))}).catch(e=>{null==t||t(void 0,e)})};return s.persist={setOptions:e=>{n={...n,...e},e.getStorage&&(o=e.getStorage())},clearStorage:()=>{null==o||o.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>u(),hasHydrated:()=>c,onHydrate:e=>(i.add(e),()=>{i.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},u(),g||h})(e,t):((e,t)=>(a,r,s)=>{let n={storage:Ae(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},c=!1;const i=new Set,l=new Set;let o=n.storage;if(!o)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),a(...e)},r,s);const d=()=>{const e=n.partialize({...r()});return o.setItem(n.name,{state:e,version:n.version})},m=s.setState;s.setState=(e,t)=>{m(e,t),d()};const x=e((...e)=>{a(...e),d()},r,s);let h;s.getInitialState=()=>x;const g=()=>{var e,t;if(!o)return;c=!1,i.forEach(e=>{var t;return e(null!=(t=r())?t:x)});const s=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=r())?e:x))||void 0;return Ee(o.getItem.bind(o))(n.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];if(n.migrate)return[!0,n.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;const[s,c]=e;if(h=n.merge(c,null!=(t=r())?t:x),a(h,!0),s)return d()}).then(()=>{null==s||s(h,void 0),h=r(),c=!0,l.forEach(e=>e(h))}).catch(e=>{null==s||s(void 0,e)})};return s.persist={setOptions:e=>{n={...n,...e},e.storage&&(o=e.storage)},clearStorage:()=>{null==o||o.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>c,onHydrate:e=>(i.add(e),()=>{i.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},n.skipHydration||g(),h||x})(e,t);const Ce=new class{cache=new Map;cacheTimestamp=new Map;CACHE_DURATION=18e5;BASE_URL="/data";getCachedData(e){const t=this.cache.get(e),a=this.cacheTimestamp.get(e);if(!t||!a)return null;return Date.now()-a>this.CACHE_DURATION?(this.cache.delete(e),this.cacheTimestamp.delete(e),null):t}setCachedData(e,t){this.cache.set(e,t),this.cacheTimestamp.set(e,Date.now())}async loadJSON(e){const t=`file:${e}`,a=this.getCachedData(t);if(a)return console.log(`从缓存加载: ${e}`),a;try{console.log(`从服务器加载: ${e}`);const a=await fetch(`${this.BASE_URL}/${e}`);if(!a.ok)throw new Error(`HTTP ${a.status}: 无法加载 ${e}`);const r=await a.json();return this.setCachedData(t,r),r}catch(r){throw console.error(`加载 ${e} 失败:`,r),new Error(`数据加载失败: ${e}`)}}async getMetadata(){return this.loadJSON("metadata.json")}async getPopularGameDetails(){return await this.loadJSON("game-details.json")}async getGameDetail(e){return(await this.getPopularGameDetails()).find(t=>t.steamId===e)||null}async searchGames(e,t=20){if(!e.trim())return{games:[],total:0,hasMore:!1};try{const a=await this.loadJSON("search-index.json"),r=await this.getPopularGameDetails(),s=e.toLowerCase(),n=s.split(/\s+/).filter(e=>e.length>0),c=a.map(e=>{let t=0;e.name.toLowerCase()===s?t+=100:e.name.toLowerCase().includes(s)&&(t+=50),(e.developer.toLowerCase().includes(s)||e.publisher.toLowerCase().includes(s))&&(t+=30);const a=e.tags.filter(e=>e.toLowerCase().includes(s)).length;return t+=10*a,n.forEach(a=>{e.searchText.includes(a)&&(t+=5),e.nameWords.forEach(e=>{(e.includes(a)||a.includes(e))&&(t+=2)})}),{item:e,score:t}}).filter(e=>e.score>0).sort((e,t)=>t.score-e.score);return{games:c.slice(0,t).map(e=>{const t=r.find(t=>t.steamId===e.item.steamId);return{steamId:e.item.steamId,name:e.item.name,type:t?.type||"game",description:t?.description||"",fullDescription:t?.fullDescription||t?.description||"",developer:e.item.developer,publisher:e.item.publisher,releaseDate:t?.releaseDate||"",comingSoon:t?.comingSoon||!1,headerImage:t?.headerImage||"",screenshots:t?.screenshots||[],movies:t?.movies||[],genres:t?.genres||[],categories:t?.categories||[],platforms:t?.platforms||{windows:!0,mac:!1,linux:!1},price:{currency:t?.price?.currency||"CNY",initial:t?.price?.initial||0,final:t?.price?.final||0,discount_percent:t?.price?.discount_percent||0,formatted:t?.price?.formatted||"价格未知"},isFree:t?.isFree||!1,dlc:t?.dlc||[],achievements:t?.achievements||0,metacriticScore:t?.metacriticScore,recommendations:t?.recommendations||0,lastUpdated:(new Date).toLocaleString()}}),total:c.length,hasMore:c.length>t}}catch(a){return console.error("搜索失败:",a),{games:[],total:0,hasMore:!1}}}async getGamePrice(e){try{const t=await this.getGameDetail(e);return t?t.price?{steamId:e,final:t.price.final,initial:t.price.initial,discount_percent:t.price.discount_percent,currency:t.price.currency,formatted:t.price.formatted,isFree:t.isFree,onSale:t.price.discount_percent>0,lastUpdated:(new Date).toLocaleString()}:{steamId:e,final:0,initial:0,discount_percent:0,currency:"CNY",formatted:"价格未知",isFree:!0,onSale:!1,lastUpdated:(new Date).toLocaleString()}:null}catch(t){return console.error(`获取游戏 ${e} 价格失败:`,t),null}}async getBatchGamePrices(e){const t={},a=e.map(async e=>({steamId:e,price:await this.getGamePrice(e)}));return(await Promise.allSettled(a)).forEach((a,r)=>{const s=e[r];"fulfilled"===a.status?t[s]=a.value.price:t[s]=null}),t}async getPriceHistory(e){try{return(await this.loadJSON("price-history.json"))[e]||[]}catch(t){return console.error(`获取游戏 ${e} 价格历史失败:`,t),[]}}async checkDataFreshness(){try{const e=await this.getMetadata(),t=new Date(e.lastUpdated),a=new Date,r=Math.floor((a.getTime()-t.getTime())/36e5);return{lastUpdated:t,isStale:r>24,hoursOld:r}}catch(e){return console.error("检查数据新鲜度失败:",e),{lastUpdated:new Date(0),isStale:!0,hoursOld:999}}}clearCache(){this.cache.clear(),this.cacheTimestamp.clear(),console.log("静态数据服务缓存已清理")}getStatus(){return{cacheSize:this.cache.size,cachedFiles:Array.from(this.cache.keys()),baseUrl:this.BASE_URL}}},Ie=Number({}.VITE_PRICE_CHECK_INTERVAL)||36e5,Pe=[{code:"USD",symbol:"$",name:"美元"},{code:"EUR",symbol:"€",name:"欧元"},{code:"GBP",symbol:"£",name:"英镑"},{code:"JPY",symbol:"¥",name:"日元"},{code:"CNY",symbol:"¥",name:"人民币"},{code:"RUB",symbol:"₽",name:"卢布"},{code:"KRW",symbol:"₩",name:"韩元"},{code:"CAD",symbol:"C$",name:"加元"},{code:"AUD",symbol:"A$",name:"澳元"}],Le="USD";const Me=new class extends h{games;alerts;priceHistory;notifications;settings;cache;constructor(){super("SteamPriceMonitor"),this.version(1).stores({games:"++id, steamId, name, lastUpdated, createdAt",alerts:"++id, gameId, steamId, isActive, triggered, createdAt, nextCheckAt",priceHistory:"++id, gameId, steamId, recordedAt, price",notifications:"++id, alertId, type, sentAt, read",settings:"++id, email, updatedAt",cache:"++id, key, expiresAt, createdAt, *tags"})}};class Oe{static instance;constructor(){}static getInstance(){return Oe.instance||(Oe.instance=new Oe),Oe.instance}async addGame(e){try{const t={...e,id:crypto.randomUUID(),createdAt:(new Date).toLocaleString(),lastUpdated:(new Date).toLocaleString()},a=await Me.games.add(t);return String(a)}catch(t){throw console.error("添加游戏失败:",t),new Error("添加游戏失败")}}async getGame(e){try{return await Me.games.get(e)}catch(t){throw console.error("Failed to get game:",t),new Error("获取游戏失败")}}async getGameBySteamId(e){try{return await Me.games.where("steamId").equals(e).first()}catch(t){throw console.error("Failed to get game by steamId:",t),new Error("获取游戏失败")}}async updateGame(e,t){try{await Me.games.update(e,{...t,lastUpdated:(new Date).toLocaleString()})}catch(a){throw console.error("Failed to update game:",a),new Error("更新游戏失败")}}async deleteGame(e){try{await Me.transaction("rw",[Me.games,Me.alerts,Me.priceHistory],async()=>{await Me.games.delete(e),await Me.alerts.where("gameId").equals(e).delete(),await Me.priceHistory.where("gameId").equals(e).delete()})}catch(t){throw console.error("Failed to delete game:",t),new Error("删除游戏失败")}}async getAllGames(){try{return await Me.games.orderBy("lastUpdated").reverse().toArray()}catch(e){throw console.error("Failed to get all games:",e),new Error("获取游戏列表失败")}}async addAlert(e){try{const t=await Me.alerts.add({...e,id:crypto.randomUUID(),createdAt:(new Date).toLocaleString(),updatedAt:(new Date).toLocaleString(),nextCheckAt:(new Date).toLocaleString(),checkCount:0});return String(t)}catch(t){throw console.error("Failed to add alert:",t),new Error("添加价格提醒失败")}}async getAlert(e){try{return await Me.alerts.get(e)}catch(t){throw console.error("Failed to get alert:",t),new Error("获取价格提醒失败")}}async updateAlert(e,t){try{await Me.alerts.update(e,{...t,updatedAt:(new Date).toLocaleString()})}catch(a){throw console.error("Failed to update alert:",a),new Error("更新价格提醒失败")}}async deleteAlert(e){try{await Me.alerts.delete(e)}catch(t){throw console.error("Failed to delete alert:",t),new Error("删除价格提醒失败")}}async getAllAlerts(){try{return await Me.alerts.orderBy("createdAt").reverse().toArray()}catch(e){throw console.error("Failed to get all alerts:",e),new Error("获取价格提醒列表失败")}}async getActiveAlerts(){try{return await Me.alerts.filter(e=>e.isActive).toArray()}catch(e){throw console.error("Failed to get active alerts:",e),new Error("获取活跃提醒失败")}}async getAlertsForCheck(){try{const e=new Date;return await Me.alerts.filter(t=>t.isActive&&!t.triggered&&new Date(t.nextCheckAt)<=e).toArray()}catch(e){throw console.error("Failed to get alerts for check:",e),new Error("获取待检查提醒失败")}}async addPriceHistory(e){try{const t=await Me.priceHistory.add({...e,id:crypto.randomUUID()});return String(t)}catch(t){throw console.error("Failed to add price history:",t),new Error("添加价格历史失败")}}async getPriceHistory(e,t=100){try{return(await Me.priceHistory.where("gameId").equals(e).toArray()).sort((e,t)=>new Date(t.recordedAt).getTime()-new Date(e.recordedAt).getTime()).slice(0,t)}catch(a){throw console.error("Failed to get price history:",a),new Error("获取价格历史失败")}}async cleanOldPriceHistory(e=365){try{const t=new Date;return t.setDate(t.getDate()-e),await Me.priceHistory.where("recordedAt").below(t).delete()}catch(t){throw console.error("Failed to clean old price history:",t),new Error("清理价格历史失败")}}async addNotification(e){try{const t=await Me.notifications.add({...e,id:crypto.randomUUID()});return String(t)}catch(t){throw console.error("Failed to add notification:",t),new Error("添加通知失败")}}async getNotifications(e=50){try{return await Me.notifications.orderBy("sentAt").reverse().limit(e).toArray()}catch(t){throw console.error("Failed to get notifications:",t),new Error("获取通知失败")}}async markNotificationAsRead(e){try{await Me.notifications.update(e,{read:!0})}catch(t){throw console.error("Failed to mark notification as read:",t),new Error("标记通知已读失败")}}async deleteNotification(e){try{await Me.notifications.delete(e)}catch(t){throw console.error("Failed to delete notification:",t),new Error("删除通知失败")}}async saveSettings(e){try{const t=await Me.settings.toCollection().first();if(t)return await Me.settings.update(t.id,{...e,updatedAt:(new Date).toLocaleString()}),t.id;{const t=await Me.settings.add({...e,id:crypto.randomUUID(),createdAt:(new Date).toLocaleString(),updatedAt:(new Date).toLocaleString(),lastLoginAt:(new Date).toLocaleString()});return String(t)}}catch(t){throw console.error("Failed to save settings:",t),new Error("保存设置失败")}}async getSettings(){try{return await Me.settings.toCollection().first()}catch(e){throw console.error("Failed to get settings:",e),new Error("获取设置失败")}}async setCache(e,t,a=36e5,r=[]){try{const s=new Date(Date.now()+a);await Me.cache.put({id:crypto.randomUUID(),key:e,data:t,expiresAt:s.toLocaleString(),createdAt:(new Date).toLocaleString(),tags:r})}catch(s){throw console.error("Failed to set cache:",s),new Error("设置缓存失败")}}async getCache(e){try{const t=new Date,a=await Me.cache.where("key").equals(e).filter(e=>new Date(e.expiresAt)>t).first();return a?a.data:null}catch(t){return console.error("获取缓存失败:",t),null}}async deleteCache(e){try{await Me.cache.where("key").equals(e).delete()}catch(t){console.error("Failed to delete cache:",t)}}async cleanExpiredCache(){try{const e=new Date;return await Me.cache.where("expiresAt").below(e).delete()}catch(e){return console.error("Failed to clean expired cache:",e),0}}async getStorageStats(){try{const[e,t,a,r,s]=await Promise.all([Me.games.count(),Me.alerts.count(),Me.priceHistory.count(),Me.notifications.count(),Me.cache.count()]),n=1e3*(e+t+a+r+s);return{totalSize:n,usedSize:n,availableSize:Math.max(0,52428800-n),itemCounts:{games:e,alerts:t,priceHistory:a,notifications:r,cache:s},oldestEntry:new Date(Date.now()-2592e6),newestEntry:new Date}}catch(e){throw console.error("Failed to get storage stats:",e),new Error("获取存储统计失败")}}async exportData(){try{const[e,t,a,r,s]=await Promise.all([Me.games.toArray(),Me.alerts.toArray(),Me.priceHistory.toArray(),Me.notifications.toArray(),Me.settings.toArray()]),n={games:e,alerts:t,priceHistory:a,notifications:r,settings:s},c=e.length+t.length+a.length+r.length+s.length,i=JSON.stringify(n),l=new Blob([i]).size,o=btoa(i).slice(0,16);return{version:"1.0.0",exportedAt:new Date,data:n,metadata:{totalItems:c,dataSize:l,checksum:o}}}catch(e){throw console.error("Failed to export data:",e),new Error("导出数据失败")}}async importData(e){try{const t={success:!1,imported:{games:0,alerts:0,priceHistory:0,notifications:0,settings:0},errors:[],warnings:[],duplicatesSkipped:0};return await Me.transaction("rw",[Me.games,Me.alerts,Me.priceHistory,Me.notifications,Me.settings],async()=>{for(const r of e.data.games)try{await Me.games.where("steamId").equals(r.steamId).first()?t.duplicatesSkipped++:(await Me.games.add(r),t.imported.games++)}catch(a){t.errors.push(`导入游戏失败: ${r.name}`)}t.success=0===t.errors.length}),t}catch(t){throw console.error("Failed to import data:",t),new Error("导入数据失败")}}async clearAllData(){try{await Me.delete(),await Me.open()}catch(e){throw console.error("Failed to clear all data:",e),new Error("清除数据失败")}}}const ze=Oe.getInstance(),$e=je()(ke(De(e=>({games:[],searchResults:null,currentGame:null,popularGames:[],loading:!1,error:null,searchLoading:!1,searchGames:async t=>{if(t.trim()){e({searchLoading:!0,error:null});try{const a=await Ce.searchGames(t);e({searchResults:a,searchLoading:!1})}catch(a){e({error:a instanceof Error?a.message:"搜索失败",searchLoading:!1})}}else e({searchResults:null})},loadPopularGames:async()=>{e({loading:!0,error:null});try{const t=await Ce.getPopularGameDetails();e({popularGames:t,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"加载热门游戏失败",loading:!1})}},addGame:async t=>{try{if(await ze.getGameBySteamId(t.steamId))return void e({error:"游戏已在监控列表中"});const a={...t,id:Date.now().toString(),createdAt:(new Date).toLocaleString()},r=await ze.addGame(a),s={...a,id:r};e(e=>({games:[...e.games,s],error:null}))}catch(a){e({error:a instanceof Error?a.message:"添加游戏失败"})}},updateGame:async(t,a)=>{try{await ze.updateGame(t,a),e(e=>({games:e.games.map(e=>e.id===t?{...e,...a}:e),error:null}))}catch(r){e({error:r instanceof Error?r.message:"更新游戏失败"})}},removeGame:async t=>{try{await ze.deleteGame(t),e(e=>({games:e.games.filter(e=>e.id!==t),error:null}))}catch(a){e({error:a instanceof Error?a.message:"删除游戏失败"})}},clearSearch:()=>{e({searchResults:null,searchLoading:!1})},clearError:()=>{e({error:null})},loadSavedGames:async()=>{e({loading:!0,error:null});try{const t=await ze.getAllGames();e({games:t,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"加载游戏列表失败",loading:!1})}}}),{name:"game-store",partialize:e=>({games:e.games,popularGames:e.popularGames})}),{name:"game-store"})),Fe=je()(ke(De((e,t)=>({alerts:[],notifications:[],loading:!1,error:null,checkingPrices:!1,stats:{total:0,active:0,triggered:0,paused:0},loadAlerts:async()=>{e({loading:!0,error:null});try{const t=await ze.getAllAlerts(),a=(await Promise.allSettled(t.map(async e=>{try{const t=await Ce.getGamePrice(e.steamId);if(t&&t.final!==e.lastPrice){const a=[{price:t.final,recordedAt:(new Date).toLocaleString()},...e.priceHistory||[]].slice(0,100),r={...e,lastPrice:t.final,currentPrice:t.final,priceHistory:a,updatedAt:(new Date).toLocaleString()};return await ze.updateAlert(e.id,{lastPrice:t.final,currentPrice:t.final,priceHistory:a,updatedAt:(new Date).toLocaleString()}),r}return{...e,priceHistory:e.priceHistory||[]}}catch(t){return console.error(`Failed to update price for alert ${e.id}:`,t),{...e,priceHistory:e.priceHistory||[]}}}))).filter(e=>"fulfilled"===e.status).map(e=>e.value),r={total:a.length,active:a.filter(e=>e.isActive&&!e.triggered).length,triggered:a.filter(e=>e.triggered).length,paused:a.filter(e=>!e.isActive).length};e({alerts:a,stats:r,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"加载提醒失败",loading:!1})}},createAlert:async a=>{e({loading:!0,error:null});try{if(t().alerts.filter(e=>e.gameId===a.gameId&&e.isActive).length>0)throw new Error("该游戏已有活跃的价格提醒");const r={gameId:a.gameId,steamId:a.steamId,gameName:a.gameName,gameImage:a.headerImage,targetPrice:a.targetPrice,currentPrice:a.currentPrice,originalPrice:a.currentPrice,currency:"CNY",discountPercent:0,targetDiscountPercent:a.targetDiscountPercent,isActive:!0,triggered:!1,notificationSent:!1,userEmail:"",createdAt:(new Date).toLocaleString(),updatedAt:(new Date).toLocaleString(),nextCheckAt:(new Date).toLocaleString(),checkCount:0,lastPrice:a.currentPrice,checkInterval:36e5,priceHistory:[]},s=await ze.addAlert(r);console.log("Created Alert:",s);const n={...r,id:s};e(e=>{const t=[...e.alerts,n];return{alerts:t,stats:{total:t.length,active:t.filter(e=>e.isActive&&!e.triggered).length,triggered:t.filter(e=>e.triggered).length,paused:t.filter(e=>!e.isActive).length},loading:!1}})}catch(r){e({error:r instanceof Error?r.message:"创建提醒失败",loading:!1})}},updateAlert:async(t,a)=>{try{await ze.updateAlert(t,a),e(e=>{const r=e.alerts.map(e=>e.id===t?{...e,...a,updatedAt:(new Date).toLocaleString()}:e);return{alerts:r,stats:{total:r.length,active:r.filter(e=>e.isActive&&!e.triggered).length,triggered:r.filter(e=>e.triggered).length,paused:r.filter(e=>!e.isActive).length},error:null}})}catch(r){e({error:r instanceof Error?r.message:"更新提醒失败"})}},deleteAlert:async t=>{try{await ze.deleteAlert(t),e(e=>{const a=e.alerts.filter(e=>e.id!==t);return{alerts:a,stats:{total:a.length,active:a.filter(e=>e.isActive&&!e.triggered).length,triggered:a.filter(e=>e.triggered).length,paused:a.filter(e=>!e.isActive).length},error:null}})}catch(a){e({error:a instanceof Error?a.message:"删除提醒失败"})}},toggleAlert:async e=>{const a=t().alerts.find(t=>t.id===e);a&&await t().updateAlert(e,{isActive:!a.isActive})},checkPrices:async()=>{e({checkingPrices:!0,error:null});try{const r=await ze.getAlertsForCheck();for(const e of r)try{const a=await Ce.getGamePrice(e.steamId);if(a){let r=!1,s="";if(e.targetDiscountPercent&&e.targetDiscountPercent>0){(e.originalPrice-a.final)/e.originalPrice*100>=e.targetDiscountPercent&&(r=!0,s=`${e.gameName||"游戏"} 已达到 ${e.targetDiscountPercent}% 折扣！现价 ¥${a.final}`)}else a.final<=e.targetPrice&&(r=!0,s=`${e.gameName||"游戏"} 已达到目标价格 ¥${e.targetPrice}`);if(r){await t().updateAlert(e.id,{triggered:!0,triggeredAt:(new Date).toLocaleString(),lastPrice:a.final,currentPrice:a.final,updatedAt:(new Date).toLocaleString()});const r={alertId:e.id,type:"price_target_reached",title:"价格提醒",message:s,data:{gameId:e.gameId,steamId:e.steamId,currentPrice:a.final,targetPrice:e.targetPrice,targetDiscountPercent:e.targetDiscountPercent},sentAt:(new Date).toLocaleString(),read:!1};await ze.addNotification(r)}else await t().updateAlert(e.id,{lastPrice:a?.final||e.lastPrice,currentPrice:a.final,updatedAt:(new Date).toLocaleString(),nextCheckAt:new Date(Date.now()+e.checkInterval).toLocaleString(),checkCount:e.checkCount+1})}}catch(a){console.error(`Failed to check price for alert ${e.id}:`,a)}await t().loadAlerts(),await t().loadNotifications(),e({checkingPrices:!1})}catch(a){e({error:a instanceof Error?a.message:"价格检查失败",checkingPrices:!1})}},loadNotifications:async()=>{try{const t=await ze.getNotifications();e({notifications:t,error:null})}catch(t){e({error:t instanceof Error?t.message:"加载通知失败"})}},markNotificationAsRead:async t=>{try{await ze.markNotificationAsRead(t),e(e=>({notifications:e.notifications.map(e=>e.id===t?{...e,read:!0}:e),error:null}))}catch(a){e({error:a instanceof Error?a.message:"标记通知失败"})}},clearError:()=>{e({error:null})},getAlertsByGame:e=>t().alerts.filter(t=>t.gameId===e),hasAlert:e=>t().alerts.some(t=>t.gameId===e)}),{name:"alert-store",partialize:e=>({alerts:e.alerts,notifications:e.notifications,stats:e.stats})}),{name:"alert-store"})),Te=(e,t={})=>{const{currency:a=Le,showSymbol:r=!0,showCode:s=!1,minimumFractionDigits:n=2,maximumFractionDigits:c=2}=t;try{const t=Pe.find(e=>e.code===a),i=t?.symbol||"$",l=e.toLocaleString("zh-CN",{minimumFractionDigits:n,maximumFractionDigits:c});let o="";return r&&(o+=i),o+=l,s&&(o+=` ${a}`),o}catch(i){return console.error("Price formatting error:",i),`${e}`}},He=e=>{if(""===e||null==e)return{isValid:!1,value:0,error:"价格不能为空"};const t="string"==typeof e?parseFloat(e):e;if(isNaN(t))return{isValid:!1,value:0,error:"请输入有效的数字"};if(t<0)return{isValid:!1,value:t,error:"价格不能为负数"};if(t>999999)return{isValid:!1,value:t,error:"价格过高"};const a=String(t),r=a.indexOf(".");return-1!==r&&a.length-r-1>2?{isValid:!1,value:t,error:"价格最多支持2位小数"}:{isValid:!0,value:t}};function Ue(...e){return g(u(e))}const Ge=({variant:t="primary",size:a="md",loading:r=!1,icon:s,children:n,className:c,disabled:i,...l})=>e.jsxs("button",{className:Ue("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-blue-500 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500 dark:text-gray-300 dark:hover:bg-gray-800",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[t],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[a],c),disabled:i||r,...l,children:[r?e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}):s?e.jsx("span",{className:"mr-2",children:s}):null,n]}),_e=({game:t,compact:a=!1})=>{const{hasAlert:r,createAlert:n,loading:c}=Fe(),[i,l]=s.useState(!1),[o,d]=s.useState(30),[m,x]=s.useState(!1),[h,g]=s.useState(0),[u,y]=s.useState(!0),p=r(t.steamId),f=t.price?.final||0,b=f*(1-o/100),v=m?h:b,j=()=>{p||l(!i)},w=async()=>{if(m||!(o<1||o>99)){if(m){const e=He(h);if(!e.isValid)return void alert(e.error)}try{await n({gameId:t.steamId,steamId:t.steamId,gameName:t.name,headerImage:t.headerImage,targetPrice:v,currentPrice:f,targetDiscountPercent:m?void 0:o,pushEnabled:u}),l(!1)}catch(e){console.error("创建提醒失败:",e)}}else alert("折扣百分比必须在 1% 到 99% 之间")};return a?e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4 p-4",children:[e.jsx("img",{src:t.headerImage||"/placeholder-game.jpg",alt:t.name,className:"w-16 h-16 object-cover rounded-lg",onError:e=>{e.target.src="/placeholder-game.jpg"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.name}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:t.price&&e.jsx("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:Te(t.price.final,{currency:"CNY"})})})]}),e.jsx(Ge,{size:"sm",variant:p?"outline":"primary",onClick:j,disabled:p,icon:p?e.jsx(A,{className:"w-4 h-4"}):i?e.jsx(D,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}),children:p?"已设置":i?"收起":"提醒"})]}),i&&!p&&e.jsxs("div",{className:"mx-4 mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border-t border-gray-200 dark:border-gray-700 space-y-3 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"提醒类型"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-1.5 rounded hover:bg-white dark:hover:bg-gray-700 transition-colors",children:[e.jsx("input",{type:"radio",name:`alertType-${t.steamId}-compact`,checked:!m,onChange:()=>x(!1),className:"w-3 h-3 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-white",children:"按折扣百分比提醒"})]})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-1.5 rounded hover:bg-white dark:hover:bg-gray-700 transition-colors",children:[e.jsx("input",{type:"radio",name:`alertType-${t.steamId}-compact`,checked:m,onChange:()=>x(!0),className:"w-3 h-3 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(A,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-white",children:"按目标价格提醒"})]})]})]})]}),!m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300",children:"目标折扣百分比"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"1",max:"99",value:o,onChange:e=>d(Number(e.target.value)),className:"w-12 px-1 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-center"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"%"}),e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["= ",e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:Te(b)})]})]})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300",children:"目标价格"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("input",{type:"number",min:"0",step:"0.01",value:h,onChange:e=>g(Number(e.target.value)),className:"flex-1 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"输入目标价格"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"元"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("input",{type:"checkbox",id:`pushEnabled-${t.steamId}-compact`,checked:u,onChange:e=>y(e.target.checked),className:"w-3 h-3 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:`pushEnabled-${t.steamId}-compact`,className:"text-xs text-gray-700 dark:text-gray-300",children:"启用推送通知"})]}),e.jsxs("div",{className:"flex space-x-1 pt-1",children:[e.jsx(Ge,{size:"sm",variant:"outline",onClick:()=>l(!1),className:"flex-1 text-xs py-1",children:"取消"}),e.jsx(Ge,{size:"sm",onClick:w,loading:c,className:"flex-1 text-xs py-1",icon:e.jsx(A,{className:"w-3 h-3"}),children:"创建提醒"})]})]})]}):e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.headerImage||"/placeholder-game.jpg",alt:t.name,className:"w-full h-48 object-cover",onError:e=>{e.target.src="/placeholder-game.jpg"}}),t.price?.discount_percent&&t.price.discount_percent>0&&e.jsxs("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full font-medium",children:["-",t.price.discount_percent,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2",children:t.name}),t.description&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:t.description}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:t.price?e.jsx("div",{className:"flex items-center space-x-2",children:t.price.discount_percent&&t.price.discount_percent>0?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-500 line-through",children:Te(t.price.initial,{currency:"CNY"})}),e.jsx("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:Te(t.price.final,{currency:"CNY"})})]}):e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:Te(t.price.final,{currency:"CNY"})})}):e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"免费"})}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(Ge,{className:"flex-1",variant:p?"outline":"primary",onClick:j,disabled:p,icon:p?e.jsx(A,{className:"w-4 h-4"}):i?e.jsx(D,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}),children:p?"已设置提醒":i?"收起设置":"设置提醒"})}),i&&!p&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-t border-gray-200 dark:border-gray-700 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"提醒类型"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 rounded-md hover:bg-white dark:hover:bg-gray-700 transition-colors",children:[e.jsx("input",{type:"radio",name:`alertType-${t.steamId}`,checked:!m,onChange:()=>x(!1),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"按折扣百分比提醒"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 rounded-md hover:bg-white dark:hover:bg-gray-700 transition-colors",children:[e.jsx("input",{type:"radio",name:`alertType-${t.steamId}`,checked:m,onChange:()=>x(!0),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"按目标价格提醒"})]})]})]})]}),!m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"目标折扣百分比"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"number",min:"1",max:"99",value:o,onChange:e=>d(Number(e.target.value)),className:"w-16 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-center"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"%"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["= ",e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:Te(b)})]})]})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"目标价格"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"0",step:"0.01",value:h,onChange:e=>g(Number(e.target.value)),className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"输入目标价格"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"元"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`pushEnabled-${t.steamId}`,checked:u,onChange:e=>y(e.target.checked),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:`pushEnabled-${t.steamId}`,className:"text-sm text-gray-700 dark:text-gray-300",children:"启用推送通知"})]}),e.jsxs("div",{className:"flex space-x-2 pt-2",children:[e.jsx(Ge,{size:"sm",variant:"outline",onClick:()=>l(!1),className:"flex-1",children:"取消"}),e.jsx(Ge,{size:"sm",onClick:w,loading:c,className:"flex-1",icon:e.jsx(A,{className:"w-4 h-4"}),children:"创建提醒"})]})]}),t.metacriticScore&&e.jsxs("div",{className:"flex items-center text-xs text-amber-600",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),t.metacriticScore]}),t.genres&&t.genres.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:t.genres.slice(0,3).map((t,a)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:t},a))})]})]})},Re=e=>{try{const t=new Date(e),a=new Date,r=Math.floor((a.getTime()-t.getTime())/1e3);if(r<60)return"刚刚";if(r<3600){return`${Math.floor(r/60)}分钟前`}if(r<86400){return`${Math.floor(r/3600)}小时前`}if(r<2592e3){return`${Math.floor(r/86400)}天前`}if(r<31536e3){return`${Math.floor(r/2592e3)}个月前`}return`${Math.floor(r/31536e3)}年前`}catch(t){return console.error("Relative time calculation error:",t),"未知时间"}},Ve=({alert:t,compact:a=!1})=>{const{deleteAlert:r,toggleAlert:n,updateAlert:c,loading:i}=Fe(),[l,o]=s.useState(!1),[d,m]=s.useState(30),[x,h]=s.useState(!1),[g,u]=s.useState(0),[y,p]=s.useState(!0);s.useEffect(()=>{t.targetDiscountPercent&&t.targetDiscountPercent>0?(h(!1),m(t.targetDiscountPercent)):(h(!0),u(t.targetPrice)),p(!0)},[t]);const f=t.originalPrice*(1-d/100),b=x?g:f,v=t.targetDiscountPercent&&t.targetDiscountPercent>0?t.originalPrice*(1-t.targetDiscountPercent/100):t.targetPrice,j=t.currentPrice<=v,w=t.isActive?j?"text-green-600":"text-blue-600":"text-gray-500";return a?e.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.gameName}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["目标: ",Te(v,{currency:t.currency})]}),e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["当前: ",Te(t.currentPrice,{currency:t.currency})]})]})]}),e.jsx("div",{className:`flex items-center ${w}`,children:t.isActive?e.jsx(A,{className:"w-4 h-4"}):e.jsx(S,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t.gameName}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:["目标价格",t.targetDiscountPercent&&e.jsxs("span",{className:"ml-1 text-xs text-blue-600 dark:text-blue-400",children:["(",t.targetDiscountPercent,"% 折扣)"]})]}),e.jsx("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:Te(t.targetPrice,{currency:t.currency})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"当前价格"}),e.jsx("p",{className:"text-lg font-bold "+(j?"text-green-600":"text-gray-900 dark:text-white"),children:Te(t.currentPrice,{currency:t.currency})})]})]}),j&&e.jsxs("div",{className:"flex items-center space-x-2 mb-3 p-2 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx(q,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("span",{className:"text-sm text-green-700 dark:text-green-300 font-medium",children:["目标价格已达到！",t.targetDiscountPercent&&e.jsxs("span",{className:"ml-1",children:["(达到 ",t.targetDiscountPercent,"% 折扣)"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["创建于 ",Re(t.createdAt)]}),e.jsx("div",{className:"flex items-center space-x-2 mt-2",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(A,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"推送通知"})]})})]}),e.jsx("div",{className:`flex items-center ${w}`,children:t.isActive?e.jsx(A,{className:"w-6 h-6"}):e.jsx(S,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(t.isActive?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:t.isActive?"活跃":"已暂停"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{size:"sm",variant:"ghost",onClick:()=>{n(t.id)},icon:t.isActive?e.jsx(S,{className:"w-4 h-4"}):e.jsx(A,{className:"w-4 h-4"}),children:t.isActive?"暂停":"启用"}),e.jsx(Ge,{size:"sm",variant:"ghost",onClick:()=>{o(!l)},icon:e.jsx(G,{className:"w-4 h-4"}),children:"编辑"}),e.jsx(Ge,{size:"sm",variant:"ghost",onClick:()=>{window.confirm("确定要删除这个价格提醒吗？")&&r(t.id)},icon:e.jsx(V,{className:"w-4 h-4"}),children:"删除"})]})]}),l&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-t border-gray-200 dark:border-gray-700 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"提醒类型"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 rounded-md hover:bg-white dark:hover:bg-gray-700 transition-colors",children:[e.jsx("input",{type:"radio",name:`editAlertType-${t.id}`,checked:!x,onChange:()=>h(!1),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"按折扣百分比提醒"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 rounded-md hover:bg-white dark:hover:bg-gray-700 transition-colors",children:[e.jsx("input",{type:"radio",name:`editAlertType-${t.id}`,checked:x,onChange:()=>h(!0),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"按目标价格提醒"})]})]})]})]}),!x&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"目标折扣百分比"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"number",min:"1",max:"99",value:d,onChange:e=>m(Number(e.target.value)),className:"w-16 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-center"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"%"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["= ",e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:Te(f,{currency:t.currency})})]})]})]}),x&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"目标价格"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"0",step:"0.01",value:g,onChange:e=>u(Number(e.target.value)),className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"输入目标价格"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"元"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`editPushEnabled-${t.id}`,checked:y,onChange:e=>p(e.target.checked),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:`editPushEnabled-${t.id}`,className:"text-sm text-gray-700 dark:text-gray-300",children:"启用推送通知"})]}),e.jsxs("div",{className:"flex space-x-2 pt-2",children:[e.jsx(Ge,{size:"sm",variant:"outline",onClick:()=>{t.targetDiscountPercent&&t.targetDiscountPercent>0?(h(!1),m(t.targetDiscountPercent)):(h(!0),u(t.targetPrice)),o(!1)},className:"flex-1",children:"取消"}),e.jsx(Ge,{size:"sm",onClick:async()=>{if(x||!(d<1||d>99)){if(x){const e=He(g);if(!e.isValid)return void window.alert(e.error)}try{await c(t.id,{targetPrice:b,targetDiscountPercent:x?void 0:d}),o(!1)}catch(e){console.error("更新提醒失败:",e)}}else window.alert("折扣百分比必须在 1% 到 99% 之间")},loading:i,className:"flex-1",icon:e.jsx(A,{className:"w-4 h-4"}),children:"保存更改"})]})]})]})})},qe=()=>{const{popularGames:t,loading:a}=$e(),{alerts:r,stats:n,loadAlerts:c}=Fe();s.useEffect(()=>{c()},[c]);const l=r.slice(0,3);return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"steam-gradient text-white rounded-lg p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Steam 游戏降价提醒"}),e.jsx("p",{className:"text-xl opacity-90 mb-6",children:"永远不错过心仪游戏的最佳价格"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs(i,{to:"/search",className:"btn-primary bg-white text-blue-600 hover:bg-gray-100 flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:"搜索游戏"})]}),e.jsxs(i,{to:"/alerts",className:"btn-secondary bg-blue-700 text-white hover:bg-blue-800 flex items-center space-x-2",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"我的提醒"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"总提醒数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(A,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"活跃提醒"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:n.active})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-full",children:e.jsx(q,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"已触发"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:n.triggered})]}),e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900 rounded-full",children:e.jsx(_,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"已暂停"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:n.paused})]}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded-full",children:e.jsx(E,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"热门游戏"}),e.jsx(i,{to:"/search",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 text-sm",children:"查看更多"})]})}),e.jsx("div",{className:"card-body",children:a?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"loading-spinner w-8 h-8"})}):t.length>0?e.jsx("div",{className:"space-y-4",children:t.slice(0,3).map(t=>e.jsx(_e,{game:t,compact:!0},t.steamId))}):e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"暂无热门游戏数据"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"最近的提醒"}),e.jsx(i,{to:"/alerts",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 text-sm",children:"查看全部"})]})}),e.jsx("div",{className:"card-body",children:l.length>0?e.jsx("div",{className:"space-y-4",children:l.map(t=>e.jsx(Ve,{alert:t,compact:!0},t.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"还没有价格提醒"}),e.jsx(i,{to:"/search",className:"btn-primary text-sm",children:"创建第一个提醒"})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"快速操作"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(i,{to:"/search",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx(H,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 mb-2"}),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"搜索游戏"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"查找并添加想要监控的游戏"})]}),e.jsxs(i,{to:"/alerts",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx(A,{className:"w-8 h-8 text-green-600 dark:text-green-400 mb-2"}),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"管理提醒"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"查看和管理所有价格提醒"})]}),e.jsxs(i,{to:"/settings",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx(E,{className:"w-8 h-8 text-purple-600 dark:text-purple-400 mb-2"}),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"设置"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"配置邮件通知和其他选项"})]})]})})]})]})};function Je(e={}){const{debounceMs:t=500,minQueryLength:a=2,autoSearch:r=!0}=e,[n,c]=s.useState(""),[i,l]=s.useState(null),[o,d]=s.useState(!1),[m,x]=s.useState(null),[h,g]=s.useState(!1),u=function(e,t){const[a,r]=s.useState(e);return s.useEffect(()=>{const a=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(a)}},[e,t]),a}(n,t),y=s.useRef(null),p=s.useCallback(async e=>{if(!e.trim()||e.length<a)return l(null),void g(!1);y.current&&y.current.abort(),y.current=new AbortController,d(!0),x(null);try{const t=await Ce.searchGames(e);if(y.current?.signal.aborted)return;l(t),g(!0)}catch(t){if(y.current?.signal.aborted)return;x(t instanceof Error?t.message:"搜索失败"),l(null)}finally{d(!1)}},[a]);s.useEffect(()=>{r&&u&&p(u)},[u,p,r]),s.useEffect(()=>()=>{y.current&&y.current.abort()},[]);const f=s.useCallback(()=>{l(null),g(!1),x(null)},[]),b=s.useCallback(()=>{x(null)},[]);return{query:n,results:i,loading:o,error:m,hasSearched:h,search:p,clearResults:f,clearError:b,setQuery:c}}const Be=({value:t,onChange:a,placeholder:r="搜索游戏...",className:s="",loading:n=!1})=>e.jsxs("div",{className:`relative ${s}`,children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n?e.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}):e.jsx(H,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:r,className:"block w-full pl-10 pr-10 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t&&e.jsx("button",{onClick:()=>{a("")},className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(B,{className:"w-5 h-5"})})]}),We=({games:t})=>e.jsx("div",{className:"space-y-4",children:t.map(t=>e.jsx(_e,{game:t,compact:!0},t.steamId))}),Ye=()=>{const[t,a]=s.useState(""),[r,n]=s.useState("grid"),[i,l]=s.useState("relevance"),[o,d]=s.useState(!1),{results:m,loading:x,error:h,setQuery:g}=Je(),{popularGames:u,loadPopularGames:y}=$e();c.useEffect(()=>{t||0!==u.length||y()},[t,u.length,y]),c.useEffect(()=>{g(t)},[t,g]);const p=t?m?.games||[]:u,f=c.useMemo(()=>{if(!p.length)return[];const e=[...p];switch(i){case"name":return e.sort((e,t)=>e.name.localeCompare(t.name));case"price":return e.sort((e,t)=>(e.price?.final||0)-(t.price?.final||0));case"release_date":return e.sort((e,t)=>new Date(t.releaseDate||0).getTime()-new Date(e.releaseDate||0).getTime());default:return e}},[p,i]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"游戏搜索"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"搜索Steam游戏并设置价格提醒"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx(Be,{value:t,onChange:a,placeholder:"搜索游戏名称...",className:"w-full"})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t?`搜索结果: ${f.length}`:`热门游戏: ${f.length}`})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:i,onChange:e=>l(e.target.value),className:"text-sm border border-gray-300 dark:border-gray-600 rounded-md px-3 py-1 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"relevance",children:"相关性"}),e.jsx("option",{value:"name",children:"名称"}),e.jsx("option",{value:"price",children:"价格"}),e.jsx("option",{value:"release_date",children:"发布日期"})]})]}),e.jsxs("div",{className:"flex items-center border border-gray-300 dark:border-gray-600 rounded-md",children:[e.jsx("button",{onClick:()=>n("grid"),className:"p-2 "+("grid"===r?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>n("list"),className:"p-2 "+("list"===r?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),children:e.jsx(M,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:()=>d(!o),className:"btn-secondary flex items-center space-x-2 "+(o?"bg-blue-600 text-white":""),children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"过滤器"})]})]})]}),o&&e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"过滤选项"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"价格范围"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",placeholder:"最低价格",className:"input-field"}),e.jsx("span",{className:"text-gray-500",children:"-"}),e.jsx("input",{type:"number",placeholder:"最高价格",className:"input-field"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"游戏类型"}),e.jsxs("select",{className:"input-field",children:[e.jsx("option",{value:"",children:"所有类型"}),e.jsx("option",{value:"action",children:"动作"}),e.jsx("option",{value:"adventure",children:"冒险"}),e.jsx("option",{value:"rpg",children:"角色扮演"}),e.jsx("option",{value:"strategy",children:"策略"}),e.jsx("option",{value:"simulation",children:"模拟"}),e.jsx("option",{value:"sports",children:"体育"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"发布年份"}),e.jsxs("select",{className:"input-field",children:[e.jsx("option",{value:"",children:"所有年份"}),e.jsx("option",{value:"2024",children:"2024"}),e.jsx("option",{value:"2023",children:"2023"}),e.jsx("option",{value:"2022",children:"2022"}),e.jsx("option",{value:"2021",children:"2021"}),e.jsx("option",{value:"older",children:"更早"})]})]})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:x?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"loading-spinner w-8 h-8"})}):h?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-red-600 dark:text-red-400 mb-4",children:["搜索出错: ",h]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"重试"})]}):f.length>0?"grid"===r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:f.map(t=>e.jsx(_e,{game:t},t.steamId))}):e.jsx(We,{games:f}):t?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"没有找到相关游戏"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"尝试使用不同的搜索关键词"})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"开始搜索游戏"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"在上方搜索栏中输入游戏名称"})]})})})]})},Ke=()=>{const{alerts:t,stats:a,loadAlerts:r,loading:n}=Fe(),[i,l]=s.useState("all"),[o,d]=s.useState("");s.useEffect(()=>{r()},[r]);const m=c.useMemo(()=>{let e=t;switch(i){case"active":e=e.filter(e=>e.isActive);break;case"triggered":e=e.filter(e=>e.triggeredAt);break;case"paused":e=e.filter(e=>!e.isActive)}return o&&(e=e.filter(e=>e.gameName.toLowerCase().includes(o.toLowerCase()))),e},[t,i,o]),x=[{key:"all",label:"全部",count:a.total},{key:"active",label:"活跃",count:a.active},{key:"triggered",label:"已触发",count:a.triggered},{key:"paused",label:"已暂停",count:a.paused}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"价格提醒"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"管理您的游戏价格提醒"})]}),e.jsx(Ge,{icon:e.jsx(F,{className:"w-5 h-5"}),onClick:()=>{window.location.href="/search"},children:"添加提醒"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:x.map(({key:t,label:a,count:r})=>e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(A,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]})})},t))}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"搜索游戏名称...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:x.map(({key:t,label:a,count:r})=>e.jsxs("button",{onClick:()=>l(t),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors "+(i===t?"bg-blue-600 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[a," (",r,")"]},t))})]})})}),e.jsx("div",{className:"space-y-4",children:n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"loading-spinner w-8 h-8"})}):m.length>0?m.map(t=>e.jsx(Ve,{alert:t},t.id)):o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"没有找到匹配的提醒"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"尝试使用不同的搜索关键词"})]}):"all"!==i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:["没有",x.find(e=>e.key===i)?.label,"的提醒"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"您可以创建新的价格提醒"}),e.jsx(Ge,{onClick:()=>{window.location.href="/search"},icon:e.jsx(F,{className:"w-5 h-5"}),children:"添加提醒"})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"还没有价格提醒"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"开始监控您感兴趣的游戏价格"}),e.jsx(Ge,{onClick:()=>{window.location.href="/search"},icon:e.jsx(F,{className:"w-5 h-5"}),children:"创建第一个提醒"})]})})]})},Qe=()=>{const{stats:t}=Fe(),[a,r]=s.useState({serviceId:"",templateId:"",publicKey:"",enabled:!1}),[n,c]=s.useState({pushEnabled:!1,emailEnabled:!1,dailySummary:!1,priceDropThreshold:20}),[i,l]=s.useState(!1);s.useEffect(()=>{o()},[]);const o=async()=>{try{const e=localStorage.getItem("emailSettings"),t=localStorage.getItem("notificationSettings");e&&r(JSON.parse(e)),t&&c(JSON.parse(t))}catch(e){console.error("加载设置失败:",e)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"设置"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"配置邮件通知和应用选项"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"邮件通知设置"})]})}),e.jsx("div",{className:"card-body space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"emailEnabled",checked:a.enabled,onChange:e=>r(t=>({...t,enabled:e.target.checked})),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"emailEnabled",className:"text-sm font-medium text-gray-900 dark:text-white",children:"启用邮件通知"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"通知设置"})]})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"pushEnabled",checked:n.pushEnabled,onChange:e=>c(t=>({...t,pushEnabled:e.target.checked})),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"pushEnabled",className:"text-sm font-medium text-gray-900 dark:text-white",children:"启用浏览器推送通知"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"价格下降阈值 (%)"}),e.jsx("input",{type:"number",min:"1",max:"100",value:n.priceDropThreshold,onChange:e=>c(t=>({...t,priceDropThreshold:parseInt(e.target.value)||20})),className:"input-field w-32"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"当价格下降超过此百分比时发送通知"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"数据管理"})]})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.total}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"总提醒数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:t.active}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"活跃提醒"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:t.triggered}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"已触发"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(Ge,{variant:"outline",onClick:async()=>{try{const e=await ze.exportData(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`steam-alerts-backup-${(new Date).toLocaleString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}catch(e){console.error("导出数据失败:",e),alert("导出数据失败")}},icon:e.jsx(C,{className:"w-4 h-4"}),children:"导出数据"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:".json",onChange:async e=>{const t=e.target.files?.[0];if(t)try{const e=await t.text(),a=JSON.parse(e);await ze.importData(a),alert("数据导入成功！"),window.location.reload()}catch(a){console.error("导入数据失败:",a),alert("导入数据失败，请检查文件格式")}},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsx(Ge,{variant:"outline",icon:e.jsx(J,{className:"w-4 h-4"}),children:"导入数据"})]}),e.jsx(Ge,{variant:"danger",onClick:async()=>{if(window.confirm("确定要清除所有数据吗？此操作不可恢复！"))try{await ze.clearAllData(),localStorage.clear(),alert("所有数据已清除"),window.location.reload()}catch(e){console.error("清除数据失败:",e),alert("清除数据失败")}},icon:e.jsx(V,{className:"w-4 h-4"}),children:"清除所有数据"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Ge,{onClick:async()=>{l(!0);try{localStorage.setItem("notificationSettings",JSON.stringify(n)),alert("设置保存成功！")}catch(e){console.error("保存设置失败:",e),alert("保存设置失败，请重试")}finally{l(!1)}},loading:i,icon:e.jsx(T,{className:"w-5 h-5"}),children:"保存设置"})})]})},Xe=({children:t})=>{const a=l(),[r,s]=c.useState(()=>{if("undefined"!=typeof window){const e=localStorage.getItem("darkMode");return null!==e?"true"===e:(console.log("如果没有保存的设置，使用系统偏好，但优先级低于手动切换11333"),window.matchMedia("(prefers-color-scheme: dark)").matches)}return!1});c.useEffect(()=>{r?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",r.toString())},[r]);const n=[{name:"首页",href:"/",icon:L},{name:"搜索",href:"/search",icon:H},{name:"提醒",href:"/alerts",icon:A},{name:"设置",href:"/settings",icon:U}],o=e=>"/"===e?"/"===a.pathname:a.pathname.startsWith(e);return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsxs("nav",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center",children:e.jsxs(i,{to:"/",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"S"})}),e.jsx("span",{className:"font-bold text-xl text-gray-900 dark:text-white",children:"Steam 降价提醒"})]})}),e.jsx("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:n.map(t=>{const a=t.icon;return e.jsxs(i,{to:t.href,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors "+(o(t.href)?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),t.name]},t.name)})})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("button",{onClick:()=>{s(!r)},className:"p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"切换深色模式",children:r?e.jsx(R,{className:"w-5 h-5"}):e.jsx(z,{className:"w-5 h-5"})})})]})}),e.jsx("div",{className:"sm:hidden",children:e.jsx("div",{className:"pt-2 pb-3 space-y-1",children:n.map(t=>{const a=t.icon;return e.jsx(i,{to:t.href,className:"block pl-3 pr-4 py-2 border-l-4 text-base font-medium transition-colors "+(o(t.href)?"bg-blue-50 dark:bg-blue-900/20 border-blue-500 text-blue-700 dark:text-blue-300":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(a,{className:"w-5 h-5 mr-3"}),t.name]})},t.name)})})})]}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"px-4 py-6 sm:px-0",children:t})}),e.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"© 2024 Steam 降价提醒. 所有权利保留."}),e.jsxs("div",{className:"flex space-x-6 mt-2 sm:mt-0",children:[e.jsx("a",{href:"https://github.com/darabongba/steam-price-monitor-frontend",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"GitHub Repo(star if u like)"}),e.jsx("a",{href:"/about",className:"text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"关于"})]})]})})})]})};const Ze=new t({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:2,refetchOnWindowFocus:!1}}});function et(){const{loadPopularGames:t}=$e(),{loadAlerts:r}=Fe();!function(e={}){const{enabled:t=!0,interval:a=Ie,onPriceUpdate:r,onPriceTarget:n}=e,[c,i]=s.useState(!1),[l,o]=s.useState(null),[d,m]=s.useState(null),[x,h]=s.useState(null),g=s.useRef(null),{alerts:u,checkPrices:y}=Fe(),p=s.useCallback(async()=>{try{h(null),o(new Date);const t=u.filter(e=>e.isActive&&!e.triggered);for(const a of t)try{const e=await Ce.getGamePrice(a.steamId);e&&(r?.(a,e),e.final<=a.targetPrice&&!a.triggered&&n?.(a,e))}catch(e){console.error(`Failed to check price for alert ${a.id}:`,e)}await y(),m(new Date(Date.now()+a))}catch(t){h(t instanceof Error?t.message:"价格检查失败")}},[u,a,r,n,y]),f=s.useCallback(async()=>{await p()},[p]),b=s.useCallback(()=>{!c&&t&&(i(!0),h(null),p(),g.current=setInterval(p,a))},[c,t,p,a]),v=s.useCallback(()=>{c&&(i(!1),m(null),g.current&&(clearInterval(g.current),g.current=null))},[c]);s.useEffect(()=>{c&&(v(),t&&b())},[a,t]),s.useEffect(()=>(t&&u.length>0?b():v(),()=>{v()}),[t,u.length]),s.useEffect(()=>{const e=()=>{document.hidden||c&&d&&new Date>d&&p()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[c,d,p])}();return s.useEffect(()=>{(async()=>{try{if(await Promise.all([t(),r()]),"serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered successfully"),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(console.log("新版本可用，准备更新"),(e=>{const t=document.createElement("div");t.innerHTML='\n    <div style="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      background: #2c3e50;\n      color: white;\n      padding: 12px;\n      text-align: center;\n      z-index: 10000;\n      font-size: 14px;\n    ">\n      <span>新版本可用！</span>\n      <button id="update-btn" style="\n        background: #3498db;\n        color: white;\n        border: none;\n        padding: 6px 12px;\n        margin-left: 12px;\n        border-radius: 4px;\n        cursor: pointer;\n      ">立即更新</button>\n      <button id="dismiss-btn" style="\n        background: transparent;\n        color: white;\n        border: 1px solid white;\n        padding: 6px 12px;\n        margin-left: 8px;\n        border-radius: 4px;\n        cursor: pointer;\n      ">稍后</button>\n    </div>\n  ',document.body.appendChild(t),document.getElementById("update-btn")?.addEventListener("click",()=>{e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"}),t.remove()}),document.getElementById("dismiss-btn")?.addEventListener("click",()=>{t.remove()})})(e))})}),navigator.serviceWorker.addEventListener("message",e=>{e.data&&"CACHES_CLEARED"===e.data.type&&(console.log("缓存已清理，页面将刷新"),window.location.reload()),e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting()})}catch(e){console.error("Service Worker registration failed:",e)}}catch(e){console.error("App initialization failed:",e)}})()},[t,r]),e.jsxs(a,{client:Ze,children:[e.jsx(o,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(Xe,{children:e.jsxs(d,{children:[e.jsx(m,{path:"/",element:e.jsx(qe,{})}),e.jsx(m,{path:"/search",element:e.jsx(Ye,{})}),e.jsx(m,{path:"/alerts",element:e.jsx(Ke,{})}),e.jsx(m,{path:"/settings",element:e.jsx(Qe,{})})]})}),e.jsx(x,{position:"top-right",toastOptions:{duration:4e3,className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",success:{iconTheme:{primary:"#10b981",secondary:"#ffffff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#ffffff"}}}})]})}),!1]})}const tt=document.getElementById("root");if(!tt)throw new Error("Root container not found");y.createRoot(tt).render(e.jsx(c.StrictMode,{children:e.jsx(et,{})}));
